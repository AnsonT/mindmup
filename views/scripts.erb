<script>
  var MM = MM || {};
  <%= erb :require_js %>
  function loadScripts(success, failure) {
    requirejs.config({
      baseUrl: "/",
      paths: {
        "external": '<%=settings.static_host%>/external',
      },
      enforceDefine: false,
      waitSeconds: 60 <% if development? then %> ,
      urlArgs: "version=" + (new Date()).getTime()
    <% end %>
    });
    requirejs(
          ["external"],
          function () {
            window.mmtimestamp.log('remote scripts loaded');
            requirejs(
              <%= join_scripts [
                "mapjs-compiled",
                "lib",
                "main"
              ] %>,
              success,
              failure
            );
          },
          failure
        );
  }
</script>
